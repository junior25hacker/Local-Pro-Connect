{% extends "base.html" %}
{% load static %}
{% block title %}Request #{{ service_request.id }} - Details{% endblock %}

{% block content %}
<div style="max-width: 800px; margin: 0 auto; padding: 20px; font-family: Arial, sans-serif;">
    <h1>Service Request #{{ service_request.id }}</h1>

    <div style="background: #f9f9f9; padding: 20px; border-radius: 8px; margin: 20px 0;">
        <h2>Request Details</h2>
        <p><strong>Description:</strong> {{ service_request.description }}</p>
        {% if service_request.date_time %}
        <p><strong>Requested Date & Time:</strong> {{ service_request.date_time|date:"M d, Y g:i A" }}</p>
        {% endif %}
        {% if service_request.price_range %}
        <p><strong>Budget:</strong> {{ service_request.price_range.label }}</p>
        {% endif %}
        <p><strong>Status:</strong> {{ service_request.get_status_display }}</p>
        {% if service_request.urgent %}
        <p><strong>Urgent:</strong> Yes</p>
        {% endif %}
    </div>

    <div style="background: #e8f4f8; padding: 20px; border-radius: 8px; margin: 20px 0;">
        <h2>Distance Information</h2>
        {% if distance is not None %}
        <p><strong>Distance between customer and provider:</strong> {{ distance|floatformat:1 }} miles</p>
        {% if user_address %}
        <p><strong>Customer Location:</strong> {{ user_address }}</p>
        {% endif %}
        {% if provider_address %}
        <p><strong>Provider Location:</strong> {{ provider_address }}</p>
        {% endif %}
        {% else %}
        <p>Distance information not available</p>
        {% endif %}
    </div>

    <div style="background: #f0f8e8; padding: 20px; border-radius: 8px; margin: 20px 0;">
        <h2>Customer Information</h2>
        <p><strong>Name:</strong> {{ service_request.user.get_full_name|default:service_request.user.username }}</p>
        {% if service_request.user.email %}
        <p><strong>Email:</strong> {{ service_request.user.email }}</p>
        {% endif %}
    </div>

    {% if service_request.provider %}
    <div style="background: #fff8e8; padding: 20px; border-radius: 8px; margin: 20px 0;">
        <h2>Provider Information</h2>
        <p><strong>Name:</strong> {{ service_request.provider_name }}</p>
        {% if service_request.provider.provider_profile %}
        <p><strong>Company:</strong> {{ service_request.provider.provider_profile.company_name }}</p>
        <p><strong>Service Type:</strong> {{ service_request.provider.provider_profile.get_service_type_display }}</p>
        {% endif %}
    </div>
    {% endif %}

    <div style="text-align: center; margin-top: 30px;">
        <a href="{% url 'requests:request_list' %}" style="background: #007bff; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;">Back to Requests</a>
    </div>
</div>
{% endblock %}
